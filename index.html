<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <title>CSSDMS数据库管理--jexcel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="css/jexcel.css" type="text/css">
  <link rel="stylesheet" href="css/jsuites.css" type="text/css">
  <link rel="stylesheet" href="css/fontCss.css" type="text/css">
  <script src="js/jexcel.js" type="text/javascript"></script>
  <script src="js/jsuites.js" type="text/javascript"></script>
  <style type="text/css">
  body,html{
    margin: 0;
    padding: 0;
    width: 100%;
  }
  .left{
    width: 220px;
    height: 100%;
    display: inline-block;
  }
  .jexcel_container{
    width: 70%;
    margin-left: 220px;
  }
  </style>
</head>
<body>
  <div id="container">
    <div class="left">我是左边导航</div>
    <div id="table"></div>
  </div>

  <script src="js/jquery1.10.2.min.js" type="text/javascript"></script>
  <script type="text/javascript">
  var data=[
    ['ID','int','10','0','','','序列号',true],
    ['PNO','nvarchar','200','0','','','编号',false],
    ['WP_NAME','varchar','50','0','','','物品名称',false],
    ['KS_NAME','varchar','50','0','','','科室名称',false],
    ['MJ_TYPE','varchar','50','0','','','灭菌类型',false],
    ['WP_GUIGE','varchar','40','0','','','物品规格',false],
    ['MJ_DATE','datetime','23','3','','','灭菌时间',false],
    ['SX_DATE','datetime','23','3','','','失效时间',false],
    ['DB_RY','varchar','50','0','','','打包人员',false],
    ['HD_RY','varchar','50','0','','','核对人员',false],
    ['GC','char','4','0','','','锅次',false],
    ['GH','varchar','2','0','','','锅号n',false]
];

  var tableExcel = jexcel(document.getElementById('table'), {
        data:data,
        // url:'data.json',
        search:true,
        colHeaders: ['列名', '数据类型', '长度','小数位','允许空','默认值','说明','主键'],
        nestedHeaders:[
        [
            { title:'表名', colspan:'8' },
        ]
        ],
        // pagination:10,   //分页
        // tableOverflow:true,  //滚动条
        lazyLoading:true,   //懒加载
        loadingSpin:true,
        // colAlignments: [ 'center', 'center', 'center', 'center','center' ],
        // columnSorting:false,  //是否可排序
        columns: [
            {
                type:'text',
                width:'150',
            },
            {
              type:'dropdown',
              width:120,
              source:['varchar','nvarchar','char','datetime','int']
              // source:[
              // {
              //     id:1,name:'男'
              // },
              // {
              //     id:2,name:'女'
              // }]
              // , autocomplete: true  //自动补全
              // , multiple: true      //多选
            },
            {
                type:'text',
                 // readOnly:true, //只读
                width:'120'
            },
            {
                type:'text',
                width:'100',
            },
            {
                type:'text',
                width:'100'
            },
            {
                type:'text',
                width:'100'
            },
            {
                type:'text',
                width:'220'
            },
            {
                type:'checkbox',
                width:'50'
            },
         ],
         //工具栏
         toolbar:[
            // {
            //     type: 'i',
            //     content: 'undo',
            //     onclick: function() {
            //         table.undo();
            //     }
            // },
            // {
            //     type: 'i',
            //     content: 'redo',
            //     onclick: function() {
            //         table.redo();
            //     }
            // },
             {
                type: 'text',
                content: 'search',
                onclick: function() {
                    table.redo();
                }
            },
            {
                type: 'select',
                k: 'font-family',
                v: ['Arial','Verdana']
            },
            {
                type: 'select',
                k: 'font-size',
                v: ['12px','14px','16px','18px','19px','20px','30px']
            },
            // {
            //     type: 'i',
            //     content: 'format_align_left',
            //     k: 'text-align',
            //     v: 'left'
            // },
            // {
            //     type:'i',
            //     content:'format_align_center',
            //     k:'text-align',
            //     v:'center'
            // },
            // {
            //     type: 'i',
            //     content: 'format_align_right', 
            //     k: 'text-align',
            //     v: 'right'
            // },
            {
                type: 'i',
                content: 'format_bold',
                k: 'font-weight',
                v: 'bold'
            },
            {
                type: 'color',
                content: 'format_color_text',
                k: 'color'
            },
            // {
            //     type: 'color',
            //     content: 'format_color_fill',
            //     k: 'background-color'
            // },
            {
                type: 'i',
                content: 'save',
                onclick: function () {
                    table.download();
                }
            },
        ],
         updateTable: function(el, cell, x, y, source, value, id) {
           //只读列设置
            if(x==4&&value!=''){
              //cell.classList.add('readonly');
            }
          }
    });
    
  </script>
</body>
</html>